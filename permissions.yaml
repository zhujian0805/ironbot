# Bot Permissions Configuration
# Strategy: Deny-all by default. Only explicitly allowed actions are permitted.
# Add actions to allow lists or enable override prompts for additional operations.

version: "1.0"

# Global settings
settings:
  default_deny: true                    # Deny all unlisted capabilities (core security model)
  log_denials: true                     # Log all permission denial events for audit
  enable_override_prompt: false         # Enable user prompts for permission overrides (global setting)

# Global blocked commands - applied to all command-based tools
# These represent destructive, dangerous, or system-critical operations
blocked_commands:
  - "rm -rf /"                          # Recursive delete entire filesystem (Linux)
  - "del /f /s /q c:\\\\"               # Recursive delete entire drive (Windows)
  - "format"                            # Format disk
  - ":(){:|:&};:"                       # Bash fork bomb
  - "mkfs"                              # Make filesystem
  - "dd if=/dev/zero"                   # Destructive disk write
  - "shutdown"                          # System shutdown
  - "reboot"                            # System reboot
  - "halt"                              # System halt
  - "init 0"                            # Runlevel 0 (shutdown)
  - "init 6"                            # Runlevel 6 (reboot)

# Allowed tools (allow-list only)
tools:
  allowed: ["run_powershell"]           # Empty by default: no tools allowed unless explicitly enabled

  # Per-tool restrictions and configurations
  restrictions:
    run_powershell:
      allowed_commands: ["*"]            # Allow all PowerShell commands
      blocked_commands: []              # Additional blocked patterns for this tool
      timeout_max: 30                   # Maximum timeout in seconds
      override_prompt: false            # Allow prompting to override denial

    run_bash:
      allowed_commands: []              # Empty = deny all commands
      blocked_commands: []              # Additional blocked patterns
      timeout_max: 30
      override_prompt: false

    read_file:
      allowed_paths: []                 # Empty = deny all paths (override with specific patterns)
      override_prompt: false

    write_file:
      allowed_paths: []                 # Empty = deny all paths
      override_prompt: false

    list_directory:
      allowed_paths: []                 # Empty = deny all paths
      override_prompt: false

# Resource-level deny rules (block access regardless of tool permissions)
# Deny rules take precedence over allow rules
resources:
  denied_paths:
    - "/etc/*"                          # System configuration (Linux)
    - "/var/log/*"                      # System logs (Linux)
    - "C:\\Windows\\*"                  # Windows system directory
    - "C:\\Program Files\\*"            # Program files
    - "*/.env"                          # Environment files with secrets
    - "*/.git/*"                        # Git internals
    - "*/secrets/*"                     # Secrets directories
  denied_patterns:                      # Additional deny patterns
    - ".*password.*"                    # Files containing "password"
    - ".*token.*"                       # Files containing "token"
    - ".*credential.*"                  # Files containing "credential"

# Allowed skills (legacy skill system)
skills:
  allowed:
    - "calculator"        # Example skill
    # - "*"               # Uncomment to allow all skills

# Allowed MCPs (Model Context Protocol servers)
mcps:
  allowed: []             # No MCPs allowed by default
  # allowed:
  #   - "filesystem"
  #   - "github"

  # MCP-specific settings
  settings:
    filesystem:
      allowed_paths:
        - "/home/user/projects"
        - "C:\\Projects"
